<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>USDT.z (USDTz) — Official Overview</title>
  <meta name="description" content="Official token overview for USDT.z (USDTz). Technical info, roles, transparency, documents, tokenomics, roadmap, and contacts. OTC & collateral usage only.">

  <!-- Icons -->
  <link rel="icon" type="image/png" href="./assets/img/logo.png" sizes="32x32">
  <link rel="icon" type="image/png" href="./assets/img/logo.png" sizes="192x192">
  <link rel="apple-touch-icon" href="./assets/img/logo.png" sizes="180x180">
  <link rel="manifest" href="./site.webmanifest">
  <meta name="theme-color" content="#1FA084">
  <meta name="msapplication-TileColor" content="#1FA084">

  <!-- Bootstrap 5 (CSS) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root { --nav-offset: 72px; }
    body { background-color: #f8f9fa; padding-top: var(--nav-offset); scroll-behavior: smooth; scroll-padding-top: var(--nav-offset); }
    .address { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size: .95rem; word-break: break-all; }
    .section-title { margin-bottom: .75rem; }
    .copy-btn { white-space: nowrap; }
    footer small a { text-decoration: none; }
    code { user-select: all; }
    .brand-logo { height: 28px; width: 28px; border-radius: 50%; object-fit: cover; margin-right: .5rem; }
    #pdfViewerBody { min-height: 70vh; }
    #pdfFrame { width: 100%; height: 75vh; border: 0; }
    @media (max-width: 576px) { #pdfFrame { height: 70vh; } }
  </style>
</head>
<body>

  <!-- Fixed navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
    <div class="container">
      <a class="navbar-brand fw-semibold d-flex align-items-center" href="#home">
        <img src="./assets/img/logo.png" alt="USDTz logo" class="brand-logo">
        <span>USDT.z (USDTz)</span>
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav" aria-controls="mainNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="mainNav">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="#home">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="#roles">Roles</a></li>
          <li class="nav-item"><a class="nav-link" href="#transparency">Transparency</a></li>
          <li class="nav-item"><a class="nav-link" href="#otc-policy">OTC Policy</a></li>
          <li class="nav-item"><a class="nav-link" href="#documents">Documents</a></li>
          <li class="nav-item"><a class="nav-link" href="#tokenomics">Tokenomics</a></li>
          <li class="nav-item"><a class="nav-link" href="#roadmap">Roadmap</a></li>
          <li class="nav-item"><a class="nav-link" href="#contact">Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- Hero / Home -->
  <header id="home" class="py-5">
    <div class="container">
      <div class="row align-items-center g-4">
        <div class="col-12 col-lg-7">
          <h1 class="display-5 fw-semibold mb-3">USDT.z <span class="text-muted">(USDTz)</span></h1>
          <p class="mb-4">Official reference page. Below you’ll find on-chain identifiers, token facts, governance roles, and public registries.</p>

          <div class="card shadow-sm">
            <div class="card-body">
              <div class="row gy-3">
                <div class="col-12 col-md-6">
                  <div class="text-muted">Symbol</div>
                  <div class="fw-semibold">USDTz</div>
                </div>
                <div class="col-12 col-md-6">
                  <div class="text-muted">Total Supply</div>
                  <div class="fw-semibold">100,000,000,000</div>
                </div>
                <div class="col-12 col-md-6">
                  <div class="text-muted">Decimals</div>
                  <div class="fw-semibold">6</div>
                </div>
                <div class="col-12">
                  <div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between">
                    <div>
                      <div class="text-muted">Token Contract (BSC)</div>
                      <div class="address" id="contractAddress">0x86e7C48432fE2f98ABc6aDcA0aF87847Ab5542ce</div>
                    </div>
                    <div class="mt-3 mt-lg-0">
                      <button class="btn btn-outline-secondary btn-sm copy-btn" onclick="copyText('#contractAddress')" aria-label="Copy contract address">Copy</button>
                      <a class="btn btn-outline-primary btn-sm" href="https://bscscan.com/address/0x86e7c48432fe2f98abc6adca0af87847ab5542ce" target="_blank" rel="noopener noreferrer">View on BscScan</a>
                    </div>
                  </div>
                </div>
                <div class="col-12">
                  <div class="text-muted">Primary Pair (PancakeSwap v3)</div>
                  <div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between">
                    <div class="address" id="pairAddress">0x5483d364EbdD0795E1F678Fa25bc365D17339d71</div>
                    <div class="mt-2 mt-lg-0">
                      <button class="btn btn-outline-secondary btn-sm copy-btn" onclick="copyText('#pairAddress')" aria-label="Copy pair address">Copy</button>
                      <a class="btn btn-outline-dark btn-sm" href="https://pancakeswap.finance/info/v3/pairs/0x5483d364EbdD0795E1F678Fa25bc365D17339d71?chain=bsc" target="_blank" rel="noopener noreferrer">View Pair (Info)</a>
                    </div>
                  </div>
                  <p class="small text-muted mt-2 mb-0">
                    Note: USDTz is for OTC and collateral operations only; public DEX trading is not offered nor supported. Any third-party pools are unofficial.
                  </p>
                </div>
              </div>
            </div>
          </div><!-- /card -->
        </div>

        <div class="col-12 col-lg-5">
          <div class="alert alert-warning border">
            <div class="fw-semibold mb-2">OTC-only scope</div>
            <ul class="mb-0">
              <li>USDTz is intended for OTC settlement and collateral use cases.</li>
              <li>No official public DEX trading or market-making is provided.</li>
              <li>On-chain references prevail over any text materials.</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- OTC Policy -->
  <section id="otc-policy" class="py-5 border-top">
    <div class="container">
      <h2 class="h3 section-title">OTC & Collateral Policy</h2>
      <p class="text-muted">
        USDTz is not offered for public exchange trading. All transfers and settlements are handled via OTC channels or as collateral arrangements with counterparties.
        Any third-party liquidity pools or secondary markets are not official nor supported.
      </p>
      <div class="d-flex flex-wrap gap-2">
        <a class="btn btn-outline-dark" href="mailto:info@usdt-z.cloud?subject=USDTz%20OTC%20Request">Request OTC Desk</a>
        <a class="btn btn-outline-secondary" href="#documents">Review Documents</a>
        <a class="btn btn-outline-primary" href="https://bscscan.com/address/0x86e7c48432fe2f98abc6adca0af87847ab5542ce" target="_blank" rel="noopener">Verify on BscScan</a>
      </div>
    </div>
  </section>

  <!-- Roles -->
  <section id="roles" class="py-5 border-top">
    <div class="container">
      <h2 class="h3 section-title">Roles</h2>
      <p class="text-muted mb-4">Assigned addresses for operational functions.</p>

      <div class="row g-4">
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body d-flex flex-column">
              <h3 class="h5 mb-2">Owner / Admin</h3>
              <div class="address flex-grow-1" id="addrOwner">0xFA4C56bC42C78816B7622f8d4EecF1caAd89fDb4</div>
              <div class="mt-3">
                <button class="btn btn-outline-secondary btn-sm copy-btn" onclick="copyText('#addrOwner')" aria-label="Copy Owner/Admin address">Copy</button>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body d-flex flex-column">
              <h3 class="h5 mb-2">Treasury</h3>
              <div class="address flex-grow-1" id="addrTreasury">0xC6BEdBB3542b044E124F1261e2D146174f622F2D</div>
              <div class="mt-3">
                <button class="btn btn-outline-secondary btn-sm copy-btn" onclick="copyText('#addrTreasury')" aria-label="Copy Treasury address">Copy</button>
              </div>
            </div>
          </div>
        </div>

        <div class="col-12 col-md-6 col-lg-4">
          <div class="card h-100 shadow-sm">
            <div class="card-body d-flex flex-column">
              <h3 class="h5 mb-2">Pauser / LP Operations</h3>
              <div class="address flex-grow-1" id="addrPauser">0x886C8047F4cF961b738a2d7b01f38c2A93d9E657</div>
              <div class="mt-3">
                <button class="btn btn-outline-secondary btn-sm copy-btn" onclick="copyText('#addrPauser')" aria-label="Copy Pauser/LP Ops address">Copy</button>
              </div>
            </div>
          </div>
        </div>
      </div><!-- /row -->
    </div>
  </section>

  <!-- Transparency -->
  <section id="transparency" class="py-5 border-top">
    <div class="container">
      <h2 class="h3 section-title">Transparency</h2>
      <p class="text-muted mb-4">Public references, registries, and verification.</p>

      <div class="list-group shadow-sm">
        <!-- CSV: View (modal) + Download -->
        <div class="list-group-item d-flex justify-content-between align-items-center flex-wrap">
          <span>Circulating registry (CSV)</span>
          <div class="btn-group">
            <button class="btn btn-outline-secondary btn-sm"
                    data-bs-toggle="modal" data-bs-target="#csvModal"
                    onclick="loadCSV('./circulating_registry.csv')">
              View
            </button>
            <a class="btn btn-outline-dark btn-sm" href="./circulating_registry.csv" download>Download</a>
          </div>
        </div>

        <!-- Pair PancakeSwap v3 (Info only) -->
        <a href="https://pancakeswap.finance/info/v3/pairs/0x5483d364EbdD0795E1F678Fa25bc365D17339d71?chain=bsc"
           target="_blank" rel="noopener noreferrer"
           class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
          <span>PancakeSwap v3 Pair (Info only)</span>
          <span class="badge bg-primary">DEX</span>
        </a>

        <!-- BscScan token contract -->
        <a href="https://bscscan.com/address/0x86e7c48432fe2f98abc6adca0af87847ab5542ce"
           target="_blank" rel="noopener noreferrer"
           class="list-group-item list-group-item-action d-flex justify-content-between align-items-center">
          <span>BscScan — Token Contract</span>
          <span class="badge bg-dark">On-chain</span>
        </a>
      </div>
    </div>
  </section>

  <!-- Documents (Audit with IPFS badges + mini viewer) -->
  <section id="documents" class="py-5 border-top">
    <div class="container">
      <h2 class="h3 section-title">Documents</h2>
      <p class="text-muted mb-4">Documentation available in PDF format.</p>

      <div class="row g-3">
        <!-- AUDIT REPORT with IPFS + SHA-256 + badges + viewer -->
        <div class="col-12">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <div class="d-flex flex-wrap justify-content-between align-items-center mb-2">
                <h3 class="h6 mb-2 mb-sm-0">Audit Report</h3>
                <div class="d-flex flex-wrap gap-2">
                  <button class="btn btn-dark btn-sm" id="openViewerBtn" data-bs-toggle="modal" data-bs-target="#pdfViewerModal">
                    Open in Viewer (auto)
                  </button>
                  <a class="btn btn-outline-dark btn-sm" href="./docs/Audit_Report.pdf" target="_blank" rel="noopener noreferrer">Open Local</a>
                </div>
              </div>

              <div class="d-flex flex-wrap gap-2 mb-2">
                <!-- Custom (primary) -->
                <a class="btn btn-outline-primary btn-sm" id="ipfsCustomLink"
                   href="https://harlequin-dear-capybara-57.mypinata.cloud/ipfs/bafkreifnl3htsqmgt34fkc3sahqedz3zesfdfdedcf4zfe5zpy26ft7c4y"
                   target="_blank" rel="noopener noreferrer">
                  Custom Gateway <span id="badgeCustom" class="badge ms-1 bg-secondary">check</span>
                </a>
                <!-- dweb.link -->
                <a class="btn btn-outline-secondary btn-sm" id="ipfsDwebLink"
                   href="https://bafkreifnl3htsqmgt34fkc3sahqedz3zesfdfdedcf4zfe5zpy26ft7c4y.ipfs.dweb.link"
                   target="_blank" rel="noopener noreferrer">
                  dweb.link <span id="badgeDweb" class="badge ms-1 bg-secondary">check</span>
                </a>
                <!-- Pinata public -->
                <a class="btn btn-outline-secondary btn-sm" id="ipfsPinataLink"
                   href="https://gateway.pinata.cloud/ipfs/bafkreifnl3htsqmgt34fkc3sahqedz3zesfdfdedcf4zfe5zpy26ft7c4y"
                   target="_blank" rel="noopener noreferrer">
                  Pinata Gateway <span id="badgePinata" class="badge ms-1 bg-secondary">check</span>
                </a>
                <!-- ipfs.io -->
                <a class="btn btn-outline-secondary btn-sm" id="ipfsPublicLink"
                   href="https://ipfs.io/ipfs/bafkreifnl3htsqmgt34fkc3sahqedz3zesfdfdedcf4zfe5zpy26ft7c4y"
                   target="_blank" rel="noopener noreferrer">
                  ipfs.io <span id="badgePublic" class="badge ms-1 bg-secondary">check</span>
                </a>
                <!-- quick-view -->
                <button class="btn btn-outline-secondary btn-sm" onclick="openPdfViewer(bestPdfURL || './docs/Audit_Report.pdf', 'Audit Report (best source)')"
                        data-bs-toggle="modal" data-bs-target="#pdfViewerModal">Quick View</button>
              </div>

              <div class="mb-2">
                <div class="text-muted small">IPFS CID</div>
                <div class="d-flex align-items-center gap-2">
                  <code id="auditCID" class="flex-grow-1">bafkreifnl3htsqmgt34fkc3sahqedz3zesfdfdedcf4zfe5zpy26ft7c4y</code>
                  <button class="btn btn-outline-secondary btn-sm copy-btn" onclick="copyText('#auditCID')" aria-label="Copy IPFS CID">Copy</button>
                </div>
              </div>

              <div class="mb-3">
                <div class="text-muted small">Gateway status legend</div>
                <div class="small text-muted">
                  <span class="badge bg-success">Verified (inline)</span> opens in-browser ·
                  <span class="badge bg-warning">Reachable (download)</span> may download ·
                  <span class="badge bg-danger">Unavailable</span> link disabled
                </div>
              </div>

              <div>
                <div class="text-muted small">SHA-256 (local file)</div>
                <div class="d-flex align-items-center gap-2">
                  <code id="auditHash" class="flex-grow-1">Computing…</code>
                  <button class="btn btn-outline-secondary btn-sm" id="hashBtn"
                          onclick="computeSHA256('./docs/Audit_Report.pdf', '#auditHash', this)">
                    Compute
                  </button>
                  <button class="btn btn-outline-secondary btn-sm copy-btn" onclick="copyText('#auditHash')" aria-label="Copy SHA-256">Copy</button>
                </div>
                <div class="form-text">Computed in your browser from <code>./docs/Audit_Report.pdf</code>.</div>
              </div>
            </div>
          </div>
        </div>

        <!-- Other PDFs -->
        <div class="col-12 col-md-4">
          <a class="btn btn-outline-dark w-100 mb-3" href="./docs/Transparency_and_Policy.pdf" target="_blank" rel="noopener noreferrer">Transparency &amp; Policy (PDF)</a>
        </div>
        <div class="col-12 col-md-4">
          <a class="btn btn-outline-dark w-100 mb-3" href="./docs/TTM.pdf" target="_blank" rel="noopener noreferrer">TTM (PDF)</a>
        </div>
        <div class="col-12 col-md-4">
          <a class="btn btn-outline-dark w-100 mb-3" href="./docs/Whitepaper_Lite.pdf" target="_blank" rel="noopener noreferrer">Whitepaper Lite (PDF)</a>
        </div>
      </div>

      <p class="text-muted small mt-3 mb-0">If a discrepancy ever exists between documents and on-chain data, on-chain records take precedence.</p>
    </div>
  </section>

  <!-- Tokenomics -->
  <section id="tokenomics" class="py-5 border-top">
    <div class="container">
      <h2 class="h3 section-title">Tokenomics</h2>
      <div class="row g-3">
        <div class="col-12 col-md-6">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <ul class="mb-0">
                <li><strong>Total Supply:</strong> 100,000,000,000 USDTz</li>
                <li><strong>Decimals:</strong> 6</li>
                <li><strong>Standard:</strong> BEP-20 (ERC-20 compatible)</li>
                <li><strong>Primary Pair:</strong> PancakeSwap v3 — <span class="address">0x5483d364EbdD0795E1F678Fa25bc365D17339d71</span> (info only)</li>
                <li><strong>Contract:</strong> <span class="address">0x86e7C48432fE2f98ABc6aDcA0aF87847Ab5542ce</span></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <p class="mb-0 text-muted">
                All token metrics and addresses are verifiable on-chain. Any discrepancy between documents and on-chain data should be resolved in favor of on-chain records.
                USDTz is not offered for public DEX trading.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Roadmap -->
  <section id="roadmap" class="py-5 border-top">
    <div class="container">
      <h2 class="h3 section-title">Roadmap</h2>
      <div class="row g-4">
        <div class="col-12 col-md-6 col-lg-3">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h3 class="h6 text-muted">Q3 2025</h3>
              <ul class="mb-0">
                <li>Token contract deployed and verified on BSC</li>
                <li>Initial public references & transparency registry</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h3 class="h6 text-muted">Q4 2025</h3>
              <ul class="mb-0">
                <li>Official website & documentation refresh</li>
                <li>OTC desk processes and collateral workflows</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h3 class="h6 text-muted">Q1 2026</h3>
              <ul class="mb-0">
                <li>Directory listings (trackers/analytics)</li>
                <li>Further transparency datasets</li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h3 class="h6 text-muted">Q2 2026</h3>
              <ul class="mb-0">
                <li>Counterparty onboarding refinements</li>
                <li>Operational policy updates</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <p class="text-muted small mt-3 mb-0">Timeline is indicative and may evolve based on community feedback and operational priorities.</p>
    </div>
  </section>

  <!-- Contact & Community -->
  <section id="contact" class="py-5 border-top">
    <div class="container">
      <h2 class="h3 section-title">Contact & Community</h2>
      <ul class="mb-3">
        <li>Email (OTC desk): <a href="mailto:info@usdt-z.cloud?subject=USDTz%20OTC%20Request">info@usdt-z.cloud</a></li>
        <li>Instagram: <a href="https://instagram.com/usdtz2025" target="_blank" rel="noopener noreferrer">@usdtz2025</a></li>
        <li>BscScan: <a href="https://bscscan.com/address/0x86e7c48432fe2f98abc6adca0af87847ab5542ce" target="_blank" rel="noopener noreferrer">Token Contract</a></li>
        <li>PancakeSwap (Info v3 Pair): <a href="https://pancakeswap.finance/info/v3/pairs/0x5483d364EbdD0795E1F678Fa25bc365D17339d71?chain=bsc" target="_blank" rel="noopener noreferrer">View Pair</a></li>
      </ul>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-4 border-top bg-white">
    <div class="container">
      <small class="text-muted d-block">
        Disclaimer: “Not affiliated with Tether. On-chain &gt; documents. OTC & collateral only; no public DEX trading offered or supported. Contacts:
        <a href="mailto:info@usdt-z.cloud">info@usdt-z.cloud</a> | Instagram
        <a href="https://instagram.com/usdtz2025" target="_blank" rel="noopener noreferrer">@usdtz2025</a>”.
      </small>
    </div>
  </footer>

  <!-- CSV Modal -->
  <div class="modal fade" id="csvModal" tabindex="-1" aria-hidden="true" aria-labelledby="csvModalTitle">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="csvModalTitle" class="modal-title">Circulating registry (CSV)</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div id="csvSpinner" class="text-center my-4">Loading…</div>
          <div class="table-responsive" id="csvTableWrap" style="display:none;">
            <table class="table table-sm table-striped">
              <thead id="csvThead"></thead>
              <tbody id="csvTbody"></tbody>
            </table>
          </div>
          <div id="csvError" class="alert alert-warning d-none">Unable to load CSV.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- PDF Viewer Modal -->
  <div class="modal fade" id="pdfViewerModal" tabindex="-1" aria-hidden="true" aria-labelledby="pdfModalTitle">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="pdfModalTitle" class="modal-title">PDF Viewer</h5>
          <a id="pdfOpenInTab" href="#" target="_blank" rel="noopener" class="btn btn-outline-secondary btn-sm me-2">Open in new tab</a>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div id="pdfViewerBody" class="modal-body">
          <div id="pdfSpinner" class="text-center my-4">Loading…</div>
          <iframe id="pdfFrame" src="" title="PDF" style="display:none;"></iframe>
          <div id="pdfError" class="alert alert-warning d-none">Unable to display PDF. Try “Open in new tab”.</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap 5 (JS bundle) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Utilities + CSV viewer + SHA-256 + IPFS verify + PDF viewer -->
  <script>
    /* ---------- utilities ---------- */
    function copyText(selector) {
      const el = document.querySelector(selector);
      if (!el) return;
      const text = el.textContent.trim();
      if (!navigator.clipboard) {
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        try { document.execCommand('copy'); } catch (e) {}
        document.body.removeChild(ta);
        return;
      }
      navigator.clipboard.writeText(text);
    }
    function escapeHtml(s) {
      return String(s ?? '').replace(/[&<>"']/g, m => (
        { '&':'&amp;', '<':'&lt;', '>':'&gt;', '"':'&quot;', "'":'&#039;' }[m]
      ));
    }

    /* ---------- CSV preview ---------- */
    async function loadCSV(path) {
      document.getElementById('csvSpinner').style.display = 'block';
      document.getElementById('csvTableWrap').style.display = 'none';
      document.getElementById('csvError').classList.add('d-none');
      document.getElementById('csvThead').innerHTML = '';
      document.getElementById('csvTbody').innerHTML = '';

      try {
        const res = await fetch(path, { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const text = await res.text();

        const rows = [];
        let row = [], cell = '', inQuotes = false;
        for (let i = 0; i < text.length; i++) {
          const c = text[i], n = text[i + 1];
          if (c === '"') {
            if (inQuotes && n === '"') { cell += '"'; i++; }
            else { inQuotes = !inQuotes; }
          } else if (c === ',' && !inQuotes) {
            row.push(cell); cell = '';
          } else if ((c === '\n' || c === '\r') && !inQuotes) {
            if (cell !== '' || row.length) { row.push(cell); rows.push(row); row = []; cell = ''; }
            if (c === '\r' && n === '\n') i++;
          } else {
            cell += c;
          }
        }
        if (cell !== '' || row.length) { row.push(cell); rows.push(row); }

        if (!rows.length) throw new Error('Empty CSV');

        const thead = document.getElementById('csvThead');
        const tbody = document.getElementById('csvTbody');

        const header = rows[0];
        const body = rows.slice(1);

        thead.innerHTML = `<tr>${header.map(h => `<th class="text-nowrap">${escapeHtml(h)}</th>`).join('')}</tr>`;
        tbody.innerHTML = body.map(r => `<tr>${r.map(v => `<td>${escapeHtml(v)}</td>`).join('')}</tr>`).join('');

        document.getElementById('csvSpinner').style.display = 'none';
        document.getElementById('csvTableWrap').style.display = '';
      } catch (e) {
        document.getElementById('csvSpinner').style.display = 'none';
        document.getElementById('csvError').classList.remove('d-none');
        console.error(e);
      }
    }

    /* ---------- SHA-256 (local) ---------- */
    async function computeSHA256(url, outSelector, btnEl) {
      try {
        if (btnEl) { btnEl.disabled = true; btnEl.textContent = 'Computing…'; }
        const res = await fetch(url, { cache: 'no-store' });
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const buf = await res.arrayBuffer();
        const hashBuffer = await crypto.subtle.digest('SHA-256', buf);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        document.querySelector(outSelector).textContent = hashHex;
      } catch (e) {
        console.error(e);
        document.querySelector(outSelector).textContent = 'Unable to compute (check file path / CORS)';
      } finally {
        if (btnEl) { btnEl.disabled = false; btnEl.textContent = 'Compute'; }
      }
    }

    /* ---------- IPFS verify (classify + choose best) ---------- */
    const IPFS_CID = 'bafkreifnl3htsqmgt34fkc3sahqedz3zesfdfdedcf4zfe5zpy26ft7c4y';
    const GW_CUSTOM = 'https://harlequin-dear-capybara-57.mypinata.cloud/ipfs/' + IPFS_CID;
    const GW_DWEB   = 'https://' + IPFS_CID + '.ipfs.dweb.link';
    const GW_PINATA = 'https://gateway.pinata.cloud/ipfs/' + IPFS_CID;
    const GW_IPFSIO = 'https://ipfs.io/ipfs/' + IPFS_CID;
    let bestPdfURL = null;

    function setBadgeEl(id, text, cls) {
      const el = document.getElementById(id);
      if (!el) return;
      el.className = 'badge ms-1 ' + cls;
      el.textContent = text;
    }
    function disableLink(id) {
      const a = document.getElementById(id);
      if (!a) return;
      a.classList.add('disabled');
      a.setAttribute('aria-disabled', 'true');
      a.setAttribute('tabindex', '-1');
      a.style.pointerEvents = 'none';
    }
    function markOpenViewer(sourceLabel, url) {
      bestPdfURL = url;
      const btn = document.getElementById('openViewerBtn');
      if (btn) btn.textContent = 'Open in Viewer (' + sourceLabel + ')';
    }

    async function classifyGateway(url) {
      try {
        let res = await fetch(url, { method: 'HEAD', cache: 'no-store' });
        if (res.ok) {
          const ct = (res.headers.get('content-type') || '').toLowerCase();
          if (ct.includes('pdf')) return 'inline';
          return 'download';
        }
      } catch (_) {}
      try {
        const res = await fetch(url, { headers: { 'Range': 'bytes=0-1023' }, cache: 'no-store' });
        if (res.ok || res.status === 206) {
          const ct = (res.headers.get('content-type') || '').toLowerCase();
          if (ct.includes('pdf')) return 'inline';
          return 'download';
        }
      } catch (_) {}
      return 'fail';
    }

    async function verifyGateways() {
      const order = [
        { link: 'ipfsCustomLink', badge: 'badgeCustom', url: GW_CUSTOM, label: 'Custom' },
        { link: 'ipfsDwebLink',   badge: 'badgeDweb',   url: GW_DWEB,   label: 'dweb.link' },
        { link: 'ipfsPinataLink', badge: 'badgePinata', url: GW_PINATA, label: 'Pinata' },
        { link: 'ipfsPublicLink', badge: 'badgePublic', url: GW_IPFSIO, label: 'ipfs.io' },
      ];

      for (const g of order) {
        setBadgeEl(g.badge, 'checking…', 'bg-secondary');
        const status = await classifyGateway(g.url);
        if (status === 'inline') {
          setBadgeEl(g.badge, 'Verified (inline)', 'bg-success');
          if (!bestPdfURL) markOpenViewer(g.label, g.url);
        } else if (status === 'download') {
          setBadgeEl(g.badge, 'Reachable (download)', 'bg-warning');
          if (!bestPdfURL) markOpenViewer(g.label, g.url);
        } else {
          setBadgeEl(g.badge, 'Unavailable', 'bg-danger');
          disableLink(g.link);
        }
      }
      if (!bestPdfURL) markOpenViewer('local', './docs/Audit_Report.pdf');
    }

    /* ---------- PDF viewer ---------- */
    function openPdfViewer(url, title) {
      const frame = document.getElementById('pdfFrame');
      const spinner = document.getElementById('pdfSpinner');
      const err = document.getElementById('pdfError');
      const link = document.getElementById('pdfOpenInTab');
      const titleEl = document.getElementById('pdfModalTitle');

      spinner.style.display = 'block';
      err.classList.add('d-none');
      frame.style.display = 'none';

      frame.onload = () => { spinner.style.display = 'none'; frame.style.display = 'block'; };
      frame.onerror = () => { spinner.style.display = 'none'; err.classList.remove('d-none'); };

      frame.src = url;
      link.href = url;
      titleEl.textContent = title || 'PDF Viewer';
    }

    /* ---------- Init ---------- */
    document.addEventListener('DOMContentLoaded', () => {
      verifyGateways();
      // auto-compute SHA-256 for local PDF (silently)
      computeSHA256('./docs/Audit_Report.pdf', '#auditHash');
      const btn = document.getElementById('openViewerBtn');
      if (btn) btn.addEventListener('click', () => openPdfViewer(bestPdfURL || './docs/Audit_Report.pdf', 'Audit Report'));
    });
  </script>
</body>
</html>
